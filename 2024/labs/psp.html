<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/2024/assets/css/just-the-docs-default.css"> <script src="/2024/assets/js/vendor/lunr.min.js"></script> <script src="/2024/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Pretty Secure Processor | 6.5950/6.5951</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Pretty Secure Processor" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Secure Hardware Design" /> <meta property="og:description" content="Secure Hardware Design" /> <meta property="og:site_name" content="6.5950/6.5951" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Pretty Secure Processor" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Secure Hardware Design","headline":"Pretty Secure Processor","url":"/2024/labs/psp.html"}</script> <!-- End Jekyll SEO tag --> <!-- Cover up the page while CSS is loading to prevent flicker --> <div id="preload-cover"></div> <style> #preload-cover { position:fixed; height:100%; width:100%; top:0; left:0; background:#fff; z-index:9999; } @media (prefers-color-scheme: dark) { #preload-cover { position:fixed; height:100%; width:100%; top:0; left:0; background:#222326; z-index:9999; } } </style> <script> window.addEventListener('load', function() { var cover = document.getElementById('preload-cover'); cover.style.display = 'none'; }); </script> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Feather. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/2024/" class="site-title lh-tight"> 6.5950/6.5951 </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/2024/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/2024/calendar.html" class="nav-list-link">Calendar</a></li><li class="nav-list-item"><a href="/2024/lectureReadings.html" class="nav-list-link">Lecture Readings</a></li><li class="nav-list-item"><a href="/2024/paperDiscussion.html" class="nav-list-link">Paper Discussion</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Recitations category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/2024/recitations.html" class="nav-list-link">Recitations</a><ul class="nav-list "><li class="nav-list-item "><a href="/2024/recitations/cpp.html" class="nav-list-link">CTF of C Programming</a></li><li class="nav-list-item "><a href="/2024/recitations/physical.html" class="nav-list-link">CTF of Physical Attacks</a></li><li class="nav-list-item "><a href="/2024/recitations/riscv.html" class="nav-list-link">Binary Exploitation and RISC-V Warmup</a></li><li class="nav-list-item "><a href="/2024/recitations/formal.html" class="nav-list-link">Formal Verification</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in Labs category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/2024/labs.html" class="nav-list-link">Labs</a><ul class="nav-list "><li class="nav-list-item "><a href="/2024/labs/fingerprinting.html" class="nav-list-link">Website Fingerprinting</a></li><li class="nav-list-item "><a href="/2024/labs/cache.html" class="nav-list-link">Cache Attacks</a></li><li class="nav-list-item "><a href="/2024/labs/spectre.html" class="nav-list-link">Spectre Attacks</a></li><li class="nav-list-item "><a href="/2024/labs/rowhammer.html" class="nav-list-link">Rowhammer</a></li><li class="nav-list-item "><a href="/2024/labs/aslr.html" class="nav-list-link">ASLR Bypasses</a></li><li class="nav-list-item active"><a href="/2024/labs/psp.html" class="nav-list-link active">Pretty Secure Processor</a></li><li class="nav-list-item "><a href="/2024/labs/fuzz.html" class="nav-list-link">CPU Fuzzing</a></li><li class="nav-list-item "><a href="/2024/labs/formal.html" class="nav-list-link">CPU Verification</a></li></ul></li><li class="nav-list-item"><a href="/2024/paperReadingGuidance.html" class="nav-list-link">Paper Readings Guidance</a></li><li class="nav-list-item"><a href="/2024/forInstructors.html" class="nav-list-link">For Instructors</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search 6.5950/6.5951" aria-label="Search 6.5950/6.5951" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/2024/labs.html">Labs</a></li> <li class="breadcrumb-nav-list-item"><span>Pretty Secure Processor</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><img src="figures/fuzz-banner.png" /></p> <p>Pretty Secure Processor is the CPU used in the <a href="fuzz.html">CPU fuzzing lab</a> this semester. Specifically, the version of the CPU is a <a href="https://github.com/jprx/pretty-secure-processor">fork of the open-source CPU</a> created by Joseph Ravichandran with <strong>intentional</strong> CPU bugs and backdoors added for students to discover and exploit. Pretty Secure Processor supports advanced debugging capabilities allowing you to debug your code on the CPU.</p> <p>This page provides an overview of the Pretty Secure System – Pretty Secure Processor plus the simulation and runtime features.</p> <h2 class="no_toc" id="frequently-asked-questions"> <a href="#frequently-asked-questions" class="anchor-heading" aria-labelledby="frequently-asked-questions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Frequently Asked Questions </h2> <ul id="markdown-toc"> <li><a href="#what-is-pretty-secure-processor" id="markdown-toc-what-is-pretty-secure-processor">What is Pretty Secure Processor?</a></li> <li><a href="#how-do-i-debug-my-code-on-pretty-secure-processor" id="markdown-toc-how-do-i-debug-my-code-on-pretty-secure-processor">How do I debug my code on Pretty Secure Processor?</a></li> <li><a href="#what-memory-resources-are-available-within-pretty-secure-processor" id="markdown-toc-what-memory-resources-are-available-within-pretty-secure-processor">What memory resources are available within Pretty Secure Processor?</a></li> <li><a href="#what-are-csrs" id="markdown-toc-what-are-csrs">What are CSRs?</a></li> <li><a href="#how-does-pretty-secure-processor-communicate-with-the-outside-world" id="markdown-toc-how-does-pretty-secure-processor-communicate-with-the-outside-world">How does Pretty Secure Processor communicate with the outside world?</a></li> <li><a href="#privilege-modes" id="markdown-toc-privilege-modes">Privilege Modes</a></li> <li><a href="#documentation-where-do-i-learn-more" id="markdown-toc-documentation-where-do-i-learn-more">Documentation: Where do I learn more?</a></li> </ul> <h2 id="what-is-pretty-secure-processor"> <a href="#what-is-pretty-secure-processor" class="anchor-heading" aria-labelledby="what-is-pretty-secure-processor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is Pretty Secure Processor? </h2> <p>Pretty Secure Processor is a fully-featured synthesizable RISC-V CPU and simulator framework. It has a lot of features that we will not use in this lab. This section provides an overview of the platform for providing background context for how the lab works, but is not needed to solve the lab. You can skip ahead to <a href="#how-do-i-debug-my-code-on-pretty-secure-processor">debugging</a> if you are not interested in the CPU/ simulator internals.</p> <p>Pretty Secure Processor is an <code class="language-plaintext highlighter-rouge">rv32i</code> CPU that supports two privilege modes – user (<code class="language-plaintext highlighter-rouge">PSP_PRIV_USER</code>) and machine (<code class="language-plaintext highlighter-rouge">PSP_PRIV_MACHINE</code>). It supports parts of the privileged RISC-V specification (although it deviates from the spec in a number of ways), meaning the CPU has support for <strong>Control and Status Registers</strong> (CSRs), privileged instructions like <code class="language-plaintext highlighter-rouge">mret</code>, and exceptions, interrupts, and system calls (with the <code class="language-plaintext highlighter-rouge">ecall</code> instruction).</p> <p>Under the hood, Pretty Secure Processor is a single core that exists as part of a bigger multicore system (called “Pretty Secure System”). Every Pretty Secure Processor core (referred to as “PSP core” for short) supports a private split L1I/ L1D cache and unified L2 cache. These cores all communicate on a shared memory ring where a variety of memory-mapped peripherals exist as nodes, such as the shared L3 cache, graphics memory, and VGA style text memory.</p> <p><img src="figures/fuzz-psp-overview.png" width="65%" /></p> <p><em>An overview of the Pretty Secure System. Your code runs on Pretty Secure Core 0.</em></p> <p>Pretty Secure System is centered around a fully featured simulation framework that allows for in-depth debugging and analysis. This testbench is implemented as a <a href="https://verilator.org">Verilator</a> C++ testbench, allowing the simulated core to communicate over the network and interact with you, the user, like any other program. For this lab, you will use two features in this framework: the emulated serial device and GDB server for debugging.</p> <!-- You have already seen some of the features of Pretty Secure System in action in the [cache recitation](../recitations/cache.html) (namely, its ability to visualize the state of the CPU caches at runtime). For this lab, we will not be using most of these features, instead just using the emulated serial device and GDB server for debugging. --> <p>Your code runs on core 0 and should ignore any other cores present. Note that we have turned off the CPU caches to make this lab simpler, so the memory ring is unused in this lab. <!-- I decided to disable caches to allow self-modifying code --> <!-- When the core needs to read or write memory, it will access its private L1 / L2 caches. If the data it needs is not present in its private cache, it will issue a request on the memory ring bus, retreive the value from the L3 cache (which may access simulated SRAM), and return the value to the core. All of this happens behind the scenes and is transparent to your code. --></p> <blockquote class="note-title"> <p>For the CPU fuzzing lab we have disabled CPU caching, making it easier for you to write self-modifying code if you wish (as you do not need to worry about flushing the instruction cache after modifying the code).</p> </blockquote> <blockquote class="fyi-title"> <p>The IPI ring is also not used in this lab. IPI stands for <strong>inter-processor interrupt</strong> and is used as a mechanism for triggering exceptions on remote cores (thus allowing cores to wake each other up and send messages back and forth). As all non-bringup cores are unused in this lab, you do not need to use IPIs. An IPI can be triggered by writing to a special memory address that maps to what we call the <em>System Management Core</em>, which causes an IPI packet to be sent to a remote core, triggering an interrupt exception.</p> <p>The memory ring is disabled as this ring is only used by the cache hierarchy. In the CPU fuzzing lab, each CPU core has a completely private single-cycle “magic” SRAM region that is used in place of the caches.</p> </blockquote> <h2 id="how-do-i-debug-my-code-on-pretty-secure-processor"> <a href="#how-do-i-debug-my-code-on-pretty-secure-processor" class="anchor-heading" aria-labelledby="how-do-i-debug-my-code-on-pretty-secure-processor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How do I debug my code on Pretty Secure Processor? </h2> <p>Pretty Secure Processor supports a custom GDB server that allows you to debug the simulated RTL itself using familiar GDB commands. Our GDB integration will allow you to set breakpoints, step through code, inspect registers, and dump memory. It does not allow you to modify any CPU state; it is a <strong>read-only</strong> view of the CPU architectural state.</p> <p>You can run the simulator in debug mode by calling it with <code class="language-plaintext highlighter-rouge">--debug</code> and then connecting a GDB to the simulator using <code class="language-plaintext highlighter-rouge">./gdb.sh</code> (which internally runs GDB’s <code class="language-plaintext highlighter-rouge">target remote</code> command). You only need to manually specify the debug port through which simulator and GDB communicate with each other: Edit <code class="language-plaintext highlighter-rouge">debug.sh</code> and fill in <code class="language-plaintext highlighter-rouge">SHD_DEBUG_PORT</code> with the debug port that was emailed to you.</p> <p>In one window:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>part1 <span class="o">&amp;&amp;</span> make <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ..
<span class="nv">$ </span>./run.sh part1 <span class="nt">--debug</span>
Waiting <span class="k">for </span>debugger on port XXXX...
</code></pre></div></div> <p>In another window:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./gdb.sh
...
Remote debugging using localhost:XXXX
start <span class="o">()</span> at bringup.s:44
44      la x1, exception_handler_entry
<span class="o">(</span>gdb<span class="o">)</span>
</code></pre></div></div> <p>Moving back to the first window, you should see:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Debugger attached!
</code></pre></div></div> <p>Now you are in a GDB session running on PSP! You can set breakpoints, inspect registers, and step through the assembly to see how your code is behaving.</p> <blockquote class="fyi-title"> <p><strong>Why is GDB read-only on PSP?</strong></p> <p>The GDB server passively observes the writeback port of the pipeline for completed instructions, reading the CPU architectural state by inspecting the core’s register file and reading control words from the end of the writeback stage. As the Pretty Secure System utilizes multiple levels of caching across multiple cores, for simplicity the GDB server provides a read-only view of memory implemented by a per-core non coherent shadow SRAM that observes all CPU reads/ writes.</p> <p>Modifying architectural state would require the debugger to be capable of modifying controlwords and hazard dependencies of in-flight instructions and injecting data into the caches (and updating the replacement policy state accordingly). As the debugger was originally built to verify the RTL is functioning correctly, we did not build these features into it.</p> </blockquote> <h2 id="what-memory-resources-are-available-within-pretty-secure-processor"> <a href="#what-memory-resources-are-available-within-pretty-secure-processor" class="anchor-heading" aria-labelledby="what-memory-resources-are-available-within-pretty-secure-processor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What memory resources are available within Pretty Secure Processor? </h2> <p>The Pretty Secure Processor memory map contains both an emulated SRAM region and a variety of memory-mapped IO (MMIO) peripherals. For the sake of this lab, you should ignore all of the MMIO devices, and only worry about the SRAM main memory region.</p> <p>SRAM is read/ write/ execute enabled and begins at <code class="language-plaintext highlighter-rouge">0x00000000</code> and ends at <code class="language-plaintext highlighter-rouge">0x04000000</code>. All of your code and data will be placed within SRAM automatically by the build system. The system stack will also be located within SRAM. If your program requires more memory than is available, you will get a linker error when you try to compile it.</p> <blockquote class="warning"> <p>While all of memory is RWX (meaning that you can write code that modifies it self), writing self-modifying code is tricky. In-flight instructions in the pipeline may not have observed all memory writes, meaning they may be executing older versions of the instructions that were just changed. As PSP does not support any memory fencing instructions, you must take care to flush the pipeline before executing any modified instructions. You can do this by running 5 <code class="language-plaintext highlighter-rouge">nop</code> instructions after writing to instructions you intend to run.</p> </blockquote> <p>All PSP cores in a system begin execution at reset by fetching the first instruction from <code class="language-plaintext highlighter-rouge">0x00000000</code>. Note that all cores execute this first instruction together, so system software should begin by initializing all system registers (eg. the exception handler, interrupt state, etc.) and then put all cores to sleep but the bringup core. Core bringup (including putting non-boot cores to sleep) is handled for you in <code class="language-plaintext highlighter-rouge">bringup.s</code>, and <code class="language-plaintext highlighter-rouge">linker.ld</code> tells the linker where SRAM is.</p> <p>When your C/ ASM code is built, it is automatically linked and loaded into SRAM properly by the linker script <code class="language-plaintext highlighter-rouge">linker.ld</code>.</p> <blockquote class="warning"> <p>There is no virtual memory support or memory protection on PSP. You will need to very carefully monitor all memory usage by your program. For example, if your stack overflows, it will just start writing data everywhere!</p> </blockquote> <h2 id="what-are-csrs"> <a href="#what-are-csrs" class="anchor-heading" aria-labelledby="what-are-csrs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What are CSRs? </h2> <p><strong>Control and Status Registers</strong> (CSRs for short) are special privileged CPU registers that configure how the CPU behaves. They can be read/ written with the <code class="language-plaintext highlighter-rouge">csrr</code>, <code class="language-plaintext highlighter-rouge">csrw</code>, and <code class="language-plaintext highlighter-rouge">csrrw</code> instructions while operating in <code class="language-plaintext highlighter-rouge">PSP_PRIV_MACHINE</code> mode.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Instruction</th> <th>Example</th> <th>Usage</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">csrr</code>- CSR Read</td> <td><code class="language-plaintext highlighter-rouge">csrr x1, SOME_CSR</code></td> <td>Read <code class="language-plaintext highlighter-rouge">SOME_CSR</code> into register <code class="language-plaintext highlighter-rouge">x1</code>.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">csrw</code>- CSR Write</td> <td><code class="language-plaintext highlighter-rouge">csrw SOME_CSR, x1</code></td> <td>Write <code class="language-plaintext highlighter-rouge">x1</code> into <code class="language-plaintext highlighter-rouge">SOME_CSR</code>.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">csrrw</code>- CSR Read and Write</td> <td><code class="language-plaintext highlighter-rouge">csrrw x1, SOME_CSR, x2</code></td> <td>Read <code class="language-plaintext highlighter-rouge">SOME_CSR</code> into register <code class="language-plaintext highlighter-rouge">x1</code> and simultaneously write <code class="language-plaintext highlighter-rouge">x2</code> into <code class="language-plaintext highlighter-rouge">SOME_CSR</code>.</td> </tr> </tbody> </table></div> <p>Pretty Secure Processor features some of the CSRs defined by the RISC-V privileged specification, simplified for a classroom setting. Here is a brief listing of the CSRs you will find relevant for this lab.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Address</th> <th>Name</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">0x037</code></td> <td><code class="language-plaintext highlighter-rouge">utimer</code></td> <td>Current Time (cycles)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x200</code></td> <td><code class="language-plaintext highlighter-rouge">SOFTSERIAL_FLAGS_CSR</code></td> <td>Returns whether data is available for reading on the serial port.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x201</code></td> <td><code class="language-plaintext highlighter-rouge">SOFTSERIAL_IO_CSR_IN</code></td> <td>Softserial data entering the CPU.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x202</code></td> <td><code class="language-plaintext highlighter-rouge">SOFTSERIAL_IO_CSR_OUT</code></td> <td>Softserial data leaving the CPU.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x305</code></td> <td><code class="language-plaintext highlighter-rouge">mtvec</code></td> <td>Machine Trap Vector Table Pointer</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x340</code></td> <td><code class="language-plaintext highlighter-rouge">mscratch</code></td> <td>Scratch Register</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x341</code></td> <td><code class="language-plaintext highlighter-rouge">mepc</code></td> <td>Exception Saved PC</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x342</code></td> <td><code class="language-plaintext highlighter-rouge">mcause</code></td> <td>Exception Cause</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0x399</code></td> <td><code class="language-plaintext highlighter-rouge">mpp</code></td> <td>Previous Privilege Level</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">0xf14</code></td> <td><code class="language-plaintext highlighter-rouge">mhartid</code></td> <td>Hardware Thread (core) ID</td> </tr> </tbody> </table></div> <p>CSRs with a <code class="language-plaintext highlighter-rouge">u</code> in front of them are accessible in userspace (and machine mode), and those with an <code class="language-plaintext highlighter-rouge">m</code> in front of them are accessible from machine mode (high privilege mode). More information on the privilege modes can be found below. Here is a description of each of these CSRs:</p> <h3 class="no_toc" id="utimer"> <a href="#utimer" class="anchor-heading" aria-labelledby="utimer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">utimer</code> </h3> <p>This is a cycle counter, analogous to <code class="language-plaintext highlighter-rouge">tsc</code> on <code class="language-plaintext highlighter-rouge">x86_64</code>. Read it to get a high resolution cycle count! This one is accessible from all privilege levels, as it is a userspace CSR.</p> <h3 class="no_toc" id="softserial"> <a href="#softserial" class="anchor-heading" aria-labelledby="softserial"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">Softserial</code> </h3> <p>These CSRs correspond to the softserial device, which is described in <a href="#how-does-pretty-secure-processor-communicate-with-the-outside-world">the IO section</a>.</p> <h3 class="no_toc" id="mtvec"> <a href="#mtvec" class="anchor-heading" aria-labelledby="mtvec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">mtvec</code> </h3> <p>The Machine Trap Vector Table Pointer points to where the CPU jumps to during an exception condition. When an exception occurs, <code class="language-plaintext highlighter-rouge">pc</code> is loaded with the contents of <code class="language-plaintext highlighter-rouge">mtvec</code> (essentially jumping the CPU to <code class="language-plaintext highlighter-rouge">mtvec</code>).</p> <p>It is set to the address of the exception handler entrypoint in <code class="language-plaintext highlighter-rouge">bringup.s</code>.</p> <h3 class="no_toc" id="mscratch"> <a href="#mscratch" class="anchor-heading" aria-labelledby="mscratch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">mscratch</code> </h3> <p>Do whatever you want with this! It’s just a free register.</p> <h3 class="no_toc" id="mepc"> <a href="#mepc" class="anchor-heading" aria-labelledby="mepc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">mepc</code> </h3> <p>When the CPU enters an exception, it records the <code class="language-plaintext highlighter-rouge">pc</code> of the faulting instruction in <code class="language-plaintext highlighter-rouge">mepc</code>. It essentially performs the same role as the return address register (<code class="language-plaintext highlighter-rouge">ra</code>) (AKA <code class="language-plaintext highlighter-rouge">x1</code>) does during a regular function return. When <code class="language-plaintext highlighter-rouge">mret</code> is executed to leave an exception context, the CPU loads <code class="language-plaintext highlighter-rouge">pc</code> with <code class="language-plaintext highlighter-rouge">mepc</code> to return to the faulting instruction.</p> <p>An exception handler can increment <code class="language-plaintext highlighter-rouge">mepc</code> before executing <code class="language-plaintext highlighter-rouge">mret</code> to skip over the faulting instruction.</p> <h3 class="no_toc" id="mcause"> <a href="#mcause" class="anchor-heading" aria-labelledby="mcause"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">mcause</code> </h3> <p>When the CPU enters an exception, the hardware automatically populates this CSR with the reason for the exception.</p> <h3 class="no_toc" id="mpp"> <a href="#mpp" class="anchor-heading" aria-labelledby="mpp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">mpp</code> </h3> <p>When the CPU enters an exception, the CPU records its previous privilege level here. On <code class="language-plaintext highlighter-rouge">mret</code> to exit the exception, the CPU restores the privilege level to whatever <code class="language-plaintext highlighter-rouge">mpp</code> contains.</p> <h3 class="no_toc" id="mhartid"> <a href="#mhartid" class="anchor-heading" aria-labelledby="mhartid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">mhartid</code> </h3> <p>This is 0 for core 0, 1 for core 1, etc.</p> <h3 class="no_toc" id="mie--mpie"> <a href="#mie--mpie" class="anchor-heading" aria-labelledby="mie--mpie"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">mie</code> / <code class="language-plaintext highlighter-rouge">mpie</code> </h3> <p><code class="language-plaintext highlighter-rouge">mie</code> specifies whether interrupts are enabled or not, and <code class="language-plaintext highlighter-rouge">mpie</code> is the saved value of <code class="language-plaintext highlighter-rouge">mie</code> to be restored at <code class="language-plaintext highlighter-rouge">mret</code>. In this lab, these CSRs can be ignored (as no interrupt-generating devices are attached to the simulated SoC). You will see these set in <code class="language-plaintext highlighter-rouge">bringup.s</code>, they can be left as is (you don’t need to change them).</p> <h2 id="how-does-pretty-secure-processor-communicate-with-the-outside-world"> <a href="#how-does-pretty-secure-processor-communicate-with-the-outside-world" class="anchor-heading" aria-labelledby="how-does-pretty-secure-processor-communicate-with-the-outside-world"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How does Pretty Secure Processor communicate with the outside world? </h2> <p>In this lab, the only form of IO will be through an emulated serial port we call <strong>softserial</strong>. You have seen serial ports in the Physical Attacks lecture and recitation, and you can think of this serial port in the same way. This serial port is implemented as a set of CSRs that the CPU can read/ write to perform IO operations, defined as followed:</p> <div class="table-wrapper"><table> <thead> <tr> <th>CSR</th> <th>Address</th> <th>Function</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">SOFTSERIAL_FLAGS_CSR</code></td> <td><code class="language-plaintext highlighter-rouge">0x200</code></td> <td>Returns whether data is available for reading.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SOFTSERIAL_IO_CSR_IN</code></td> <td><code class="language-plaintext highlighter-rouge">0x201</code></td> <td>Data entering the CPU.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">SOFTSERIAL_IO_CSR_OUT</code></td> <td><code class="language-plaintext highlighter-rouge">0x202</code></td> <td>Data leaving the CPU.</td> </tr> </tbody> </table></div> <p>When data is ready for the CPU to read, <code class="language-plaintext highlighter-rouge">SOFTSERIAL_FLAGS_CSR</code> is set to <code class="language-plaintext highlighter-rouge">SOFTSERIAL_FLAGS_WAITING</code>. The CPU can poll this register to learn when data is ready to be read. If there is data available, when <code class="language-plaintext highlighter-rouge">SOFTSERIAL_IO_CSR_IN</code> is read, the ASCII code for that character will be returned. The CPU then sets <code class="language-plaintext highlighter-rouge">SOFTSERIAL_FLAGS_CSR</code> to <code class="language-plaintext highlighter-rouge">SOFTSERIAL_FLAGS_CLEAR</code> to indicate it has read and received the available byte. The CPU can output data at any time by writing to <code class="language-plaintext highlighter-rouge">SOFTSERIAL_IO_CSR_OUT</code>, which will output text to the terminal.</p> <p>We have provided a full serial driver for you in the starter code distribution in <code class="language-plaintext highlighter-rouge">serial.c</code> and <code class="language-plaintext highlighter-rouge">serial_csr.s</code>, allowing you to use the serial port without needing to implement these low-level details. However, we encourage you to read through the serial driver and understand it, as understanding it will help with understanding how to read CSRs for later parts of the lab.</p> <p>In <code class="language-plaintext highlighter-rouge">utils.c</code> we have implemented a version of <code class="language-plaintext highlighter-rouge">printf</code> that you can use to print debug information. <code class="language-plaintext highlighter-rouge">printf</code> utilizes the softserial driver to display information in the terminal. Note that our starter <code class="language-plaintext highlighter-rouge">printf</code> only supports <code class="language-plaintext highlighter-rouge">%x</code>, <code class="language-plaintext highlighter-rouge">%c</code>, and <code class="language-plaintext highlighter-rouge">%s</code>– NOT <code class="language-plaintext highlighter-rouge">%d</code> or any advanced formatter codes! (Feel free to add support for any other format strings if you want though!)</p> <h2 id="privilege-modes"> <a href="#privilege-modes" class="anchor-heading" aria-labelledby="privilege-modes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Privilege Modes </h2> <p>The RISC-V Privileged ISA specification defines four privilege modes that a CPU can support – User, Supervisor, <code class="language-plaintext highlighter-rouge">[Reserved]</code>, and Machine. Of these four, Pretty Secure Processor implements two – User and Machine, which we call <code class="language-plaintext highlighter-rouge">PSP_PRIV_USER</code> and <code class="language-plaintext highlighter-rouge">PSP_PRIV_MACHINE</code>. You can think of them like ring 3 and ring 0 (userspace and kernelspace) on <code class="language-plaintext highlighter-rouge">x86_64</code> machines, like we saw in the spectre lab.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Mode</th> <th>Code</th> <th>Restrictions</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">PSP_PRIV_USER</code></td> <td><code class="language-plaintext highlighter-rouge">0x0</code></td> <td>Cannot read machine CSRs.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">PSP_PRIV_MACHINE</code></td> <td><code class="language-plaintext highlighter-rouge">0x3</code></td> <td>None.</td> </tr> </tbody> </table></div> <p>During bringup, the CPU begins executing in <code class="language-plaintext highlighter-rouge">PSP_PRIV_MACHINE</code> and has access to all CSRs. When the CPU transitions into <code class="language-plaintext highlighter-rouge">PSP_PRIV_USER</code>, certain CSRs will be blocked. In this lab, one of your tasks is to find a backdoor in the CPU allowing you to elevate your privilege level from user mode to machine mode to dump privileged CSRs that cannot be read from user mode.</p> <p>Note that there is no way to read the current achitectural privilege level on Pretty Secure Processor as it is not stored in a CSR (it is saved in an architecturally transparent register). The privilege level can be inferred by attempting to read a privileged CSR.</p> <h3 class="no_toc" id="privilege-transitions--exception-entry"> <a href="#privilege-transitions--exception-entry" class="anchor-heading" aria-labelledby="privilege-transitions--exception-entry"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Privilege Transitions – Exception Entry </h3> <p>Privilege transitions happen in one of two ways – exception entry (an interrupt, system call, or exception occurred), or exception exit (the CPU ran <code class="language-plaintext highlighter-rouge">mret</code>). First, if the CPU encounters an exception, it will immediately switch into <code class="language-plaintext highlighter-rouge">PSP_PRIV_MACHINE</code> mode to handle it. The CPU will also save a few CSRs by writing them into their “previous” counterparts so they can be restored later. For example, the privilege level is recorded into <code class="language-plaintext highlighter-rouge">mpp</code> (Machine previous privilege) as we always move to high privilege mode during exceptions, and need to know which mode to return to when we execute <code class="language-plaintext highlighter-rouge">mret</code> (see Exception Exit).</p> <p>Here is the actual RTL that is executed on an exception condition:</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">csr</span><span class="p">[</span><span class="n">mepc</span><span class="p">]</span>      <span class="o">&lt;=</span> <span class="n">exception_saved_pc</span><span class="p">;</span>   <span class="c1">// Save address of the instruction that caused the exception</span>
<span class="n">csr</span><span class="p">[</span><span class="n">mpp</span><span class="p">]</span>       <span class="o">&lt;=</span> <span class="n">psp_priv_level</span><span class="p">;</span>       <span class="c1">// Save current CPU privilege level</span>
<span class="n">csr</span><span class="p">[</span><span class="n">mcause</span><span class="p">]</span>    <span class="o">&lt;=</span> <span class="n">exception_cause</span><span class="p">;</span>      <span class="c1">// Load reason for the exception</span>
<span class="n">psp_priv_level</span> <span class="o">&lt;=</span> <span class="n">PSP_PRIV_MACHINE</span><span class="p">;</span>     <span class="c1">// Transition to machine (privileged) mode</span>
</code></pre></div></div> <h3 class="no_toc" id="privilege-transitions--exception-exit"> <a href="#privilege-transitions--exception-exit" class="anchor-heading" aria-labelledby="privilege-transitions--exception-exit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Privilege Transitions – Exception Exit </h3> <p>After handling the exception, system software can execute the special <code class="language-plaintext highlighter-rouge">mret</code> instruction to return from the exception context. This is the only way for the CPU to move from <code class="language-plaintext highlighter-rouge">PSP_PRIV_MACHINE</code> to <code class="language-plaintext highlighter-rouge">PSP_PRIV_USER</code>. This undoes what happens during exception entry. Here is a pseudocode for the RTL that is executed on <code class="language-plaintext highlighter-rouge">mret</code>:</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">psp_priv_level</span> <span class="o">&lt;=</span> <span class="n">csr</span><span class="p">[</span><span class="n">mpp</span><span class="p">];</span>   <span class="c1">// Set the privilege level to what is in mpp</span>
<span class="n">pc</span>             <span class="o">&lt;=</span> <span class="n">csr</span><span class="p">[</span><span class="n">mepc</span><span class="p">];</span>  <span class="c1">// Jump to wherever mepc points</span>
</code></pre></div></div> <blockquote class="note-title"> <p>You do not need to be in an exception context to use <code class="language-plaintext highlighter-rouge">mret</code>!</p> <p>That is, you can run <code class="language-plaintext highlighter-rouge">mret</code> at any time if you are in machine mode – you don’t have to have just begun an exception to use it.</p> <p>For example, in <code class="language-plaintext highlighter-rouge">bringup.s</code>, we execute <code class="language-plaintext highlighter-rouge">mret</code> early on to jump into the main C code. We do this because using <code class="language-plaintext highlighter-rouge">mret</code> (again, even though we aren’t in an exception!) is the only way to change the CPU privilege level to <code class="language-plaintext highlighter-rouge">PSP_PRIV_USER</code>. Essentially, it is a convenient way to set the privilege level and execute <code class="language-plaintext highlighter-rouge">ret</code> all in one.</p> </blockquote> <h2 id="documentation-where-do-i-learn-more"> <a href="#documentation-where-do-i-learn-more" class="anchor-heading" aria-labelledby="documentation-where-do-i-learn-more"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Documentation: Where do I learn more? </h2> <p>Throughout this lab, it may be helpful to refer to the RISC-V specification to refresh yourself on the RV32I instruction encoding.</p> <blockquote class="note-title"> <p>You do not need to read the specification cover to cover! We will link to specific chapters and pages to refer to when you need to. You might find exploring them useful regardless.</p> </blockquote> <h3 class="no_toc" id="risc-v-isa-volume-i-unprivileged-specification-regular-instructions"> <a href="#risc-v-isa-volume-i-unprivileged-specification-regular-instructions" class="anchor-heading" aria-labelledby="risc-v-isa-volume-i-unprivileged-specification-regular-instructions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/riscv/riscv-isa-manual/releases/download/Ratified-IMAFDQC/riscv-spec-20191213.pdf">RISC-V ISA Volume I: Unprivileged Specification (regular instructions)</a> </h3> <p>This walks through the RISC-V instructions. The <code class="language-plaintext highlighter-rouge">rv32i</code> ISA is described in Chapter 2 (page 13). All instruction encodings are listed on page 130.</p> <h3 class="no_toc" id="risc-v-isa-volume-ii-privileged-specification-system-instructions-and-csrs"> <a href="#risc-v-isa-volume-ii-privileged-specification-system-instructions-and-csrs" class="anchor-heading" aria-labelledby="risc-v-isa-volume-ii-privileged-specification-system-instructions-and-csrs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/riscv/riscv-isa-manual/releases/download/Priv-v1.12/riscv-privileged-20211203.pdf">RISC-V ISA Volume II: Privileged Specification (system instructions and CSRs)</a> </h3> <p>This walks through the privileged ISA. It is a good resource to refer to if you are confused on how certain CSRs work.</p> <h3 class="no_toc" id="risc-v-assembly-format-of-instructions-directly-implemented-by-the-hardware-and-pseudo-instructions"> <a href="#risc-v-assembly-format-of-instructions-directly-implemented-by-the-hardware-and-pseudo-instructions" class="anchor-heading" aria-labelledby="risc-v-assembly-format-of-instructions-directly-implemented-by-the-hardware-and-pseudo-instructions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RISC-V assembly format of <a href="https://github.com/metheis/riscv/blob/master/index.md#rv32i-base-integer-instruction-set">instructions directly implemented by the hardware</a> and <a href="https://github.com/metheis/riscv/blob/master/asm.md#assembler-pseudo-instructions">pseudo instructions</a> </h3> <p>When you try to write assembly code of RISC-V instructions, These documents summarize their formats.</p> <h3 class="no_toc" id="risc-v-calling-convention"> <a href="#risc-v-calling-convention" class="anchor-heading" aria-labelledby="risc-v-calling-convention"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://riscv.org/wp-content/uploads/2015/01/riscv-calling.pdf">RISC-V Calling Convention</a> </h3> <p>This document walks through how to call C methods from assembly. <strong>Table 18.2</strong> will be useful!</p> <h3 class="no_toc" id="risc-v-assembly-programmers-manual"> <a href="#risc-v-assembly-programmers-manual" class="anchor-heading" aria-labelledby="risc-v-assembly-programmers-manual"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://github.com/riscv-non-isa/riscv-asm-manual/blob/master/riscv-asm.md">RISC-V Assembly Programmer’s Manual</a> </h3> <p>This provides an overview of what the RISC-V assembler is doing “under the hood” – demystifying various pseudoinstructions.</p> <h3 class="no_toc" id="pretty-secure-processor-complete-documentation"> <a href="#pretty-secure-processor-complete-documentation" class="anchor-heading" aria-labelledby="pretty-secure-processor-complete-documentation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a href="https://www.ideals.illinois.edu/items/118089">Pretty Secure Processor Complete Documentation</a> </h3> <p>Chapters 3 and 4 describe the Pretty Secure Processor hardware and how to write software for it.</p> <h3 class="no_toc" id="deviations-from-the-risc-v-specification"> <a href="#deviations-from-the-risc-v-specification" class="anchor-heading" aria-labelledby="deviations-from-the-risc-v-specification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deviations from the RISC-V Specification </h3> <p>Pretty Secure Processor makes a number of simplifications to make it easier to write software for. It does not implement the full privileged specification, for example there is no <code class="language-plaintext highlighter-rouge">mstatus</code> register. It also includes some non standard CSRs such as <code class="language-plaintext highlighter-rouge">utimer</code> and the softserial device. In general, concepts from the RISC-V Privileged ISA will be applicable on PSP, but refer to the CSRs and behavior listed here as the primary resource on how to use PSP.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
